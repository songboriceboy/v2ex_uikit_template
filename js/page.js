function Print(i){if(isIE){window.print()}else{var i=i?i:"content";var w=window.open("","","");w.opener=null;w.document.write('<div style="width:630px;">'+Dd(i).innerHTML+"</div>");w.window.print()}}function addFav(t){document.write('<a href="'+window.location.href+'" title="'+document.title.replace(/<|>|'|"|&/g,"")+'" rel="sidebar" onclick="if(UA.indexOf(\'chrome\') != -1){alert(\''+L["chrome_fav_tip"]+"');return false;}window.external.addFavorite(this.href, this.title);return false;\">"+t+"</a>")}function SendPage(){var htm='<form method="post" action="'+MEPath+'sendmail.php" id="dsendmail" target="_blank">';htm+='<input type="hidden" name="action" value="page"/>';htm+='<input type="hidden" name="title" value="'+$("#title").html()+'"/>';htm+='<input type="hidden" name="linkurl" value="'+window.location.href+'"/>';htm+="</form>";$("#destoon_space").html(htm);Dd("dsendmail").submit()}function SendFav(){var htm='<form method="post" action="'+MEPath+'favorite.php" id="dfavorite" target="_blank">';htm+='<input type="hidden" name="action" value="add"/>';htm+='<input type="hidden" name="title" value="'+$("#title").html()+'"/>';htm+='<input type="hidden" name="url" value="'+window.location.href+'"/>';htm+="</form>";$("#destoon_space").html(htm);Dd("dfavorite").submit()}function Dsearch(i,flag){Dd("destoon_kw").value=Dd("destoon_kw").value.replace(/=/gi,"");Dd("destoon_kw").value=$.trim(Dd("destoon_kw").value);if(Dd("destoon_kw").value.length<2||Dd("destoon_kw").value==L["keyword_message"]){Dd("destoon_kw").focus();showmsg("关键词长度必须大于2",3000,"bottom-right");return false}saveSearchHistory(Dd("destoon_kw"));if(i&&Dd("destoon_search").action.indexOf("/api/")==-1){$("#destoon_moduleid").remove();$("#destoon_spread").remove()}if(flag){Dd("destoon_search").submit()}else{return true}}function saveSearchHistory(obj,flag){if(flag){obj.value=obj.value.replace(/=/gi,"");obj.value=$.trim(obj.value);if(obj.value&&obj.value.length<2){obj.focus();showmsg("关键词长度必须大于2",3000);return false}}if($.trim(obj.value).length<2||$.trim(obj.value).length>9){return true}if(get_cookie("history_search")){var arr=unique(get_cookie("history_search").split("="));var len=arr.length;if(len>4){arr=arr.slice(-4)}arr=arr.join("=");set_cookie("history_search",arr+"="+$.trim(obj.value))}else{set_cookie("history_search",$.trim(obj.value))}}function clearSearchHistory(){if($.trim($("#search_history").html())!=""){dialog(2,"您确认清除",function(){set_cookie("history_search","");$("#search_history").html("");showmsg("您的搜索历史清除成功")})}else{showmsg("您没有搜索历史可以清除")}}function Dsearch_adv(){Go(Dd("destoon_search").action.indexOf("/api/")!=-1?DTPath+"api/search.php?moduleid="+Dd("destoon_moduleid").value:Dd("destoon_search").action)}function Dsearch_top(){if(Dsearch(0)){Dd("destoon_search").action=DTPath+"api/search.php";Dd("destoon_spread").value=1;Dd("destoon_search").submit()}}function View(s){window.open(EXPath+"view.php?img="+s)}function setModule(i,n){Dd("destoon_search").action=DTPath+"api/search.php";Dd("destoon_moduleid").value=i;searchid=i;Dd("destoon_select").value=n;$("#search_module").fadeOut("fast");Dd("destoon_kw").focus()}function setTip(w){Dh("search_tips");Dd("destoon_kw").value=w;Dd("destoon_search").submit()}function setTip1(w){$("#mb_search").removeClass("uk-open");Dd("destoon_kw").value=w;Dd("destoon_search").submit()}var tip_word="",tips_index=-1;function STip(w){if(w.length<2){Dd("search_tips").innerHTML="";Dh("search_tips");return}if(w==tip_word){return}else{tip_word=w}makeRequest("action=tipword&mid="+searchid+"&word="+w,AJPath,"_STip")}function _STip(){if(xmlHttp.readyState==4&&xmlHttp.status==200){if(xmlHttp.responseText){Ds("search_tips");Dd("search_tips").innerHTML=xmlHttp.responseText+"<label onclick=\"Dh('search_tips');\">"+L["search_tips_close"]+"&nbsp;&nbsp;</label>"}else{Dd("search_tips").innerHTML="";Dh("search_tips")}}}function STipMB(w){if(w.length<2){Dd("mb_search_tips").innerHTML="";$("#mb_search").removeClass("uk-open");return}if(w==tip_word){return}else{tip_word=w}makeRequest("action=tipword&mid="+searchid+"&word="+w,AJPath,"_STipMB")}function _STipMB(){if(xmlHttp.readyState==4&&xmlHttp.status==200){if(xmlHttp.responseText){$("#mb_search").addClass("uk-open");Dd("mb_search_tips").innerHTML=xmlHttp.responseText;var size=$(".search-tips-link").size();if(size<1){return}tips_index=-1;$("#destoon_kw").keydown(function(event){var event=window.event||event;var key=event.keyCode;if(key==38){tips_index--;if(tips_index==-1){tips_index=size-1}}else{if(key==40){tips_index++;if(tips_index==size){tips_index=0}}}var li=$("#mb_search_tips").find("li:eq("+tips_index+")");if(key==13){if(size<1){Dsearch(1,2)}else{Dd("destoon_kw").value=li.data("mb-search-word")}}li.addClass("search-tips-select").siblings().removeClass("search-tips-select");$("#mb_search_tips li").hover(function(){tips_index=$(this).index();$("#mb_search_tips li").removeClass("search-tips-select")},function(){li=$("#mb_search_tips").find("li:eq("+tips_index+")");li.addClass("search-tips-select").siblings().removeClass("search-tips-select")})})}else{Dd("mb_search_tips").innerHTML="";$("#mb_search").removeClass("uk-open")}}}function SCTip(k){var o=Dd("search_tips");if(o.style.display=="none"){if(o.innerHTML!=""){Ds("search_tips")}}else{if(k==13){Dd("destoon_search").submit();return}Dd("destoon_kw").blur();var d=o.getElementsByTagName("div");var l=d.length;var n,p;var c=w=-2;for(var i=0;i<l;i++){if(d[i].className=="search_t_div_2"){c=i}}if(c==-2){n=0;p=l-1}else{if(c==0){n=1;p=-1}else{if(c==l-1){n=-1;p=l-2}else{n=c+1;p=c-1}}}w=k==38?p:n;if(c>=0){d[c].className="search_t_div_1"}if(w>=0){d[w].className="search_t_div_2"}if(w>=0){var r=d[w].innerHTML.split(">");Dd("destoon_kw").value=r[2]}else{Dd("destoon_kw").value=tip_word}}}function user_login(){if(Dd("user_name").value.length<2){Dd("user_name").focus();return false}if(Dd("user_pass").value=="password"||Dd("user_pass").value.length<6){Dd("user_pass").focus();return false}if(Dd("captcha").value.length<3){Dd("captcha").focus();return false}}function show_answer(i){document.write('<iframe src="'+MEPath+"answer.php?itemid="+i+'" name="destoon_answer" id="des'+'toon_answer" style="width:100%;height:0px;" scrolling="no" frameborder="0"></iframe>')}function show_task(s){document.write('<script type="text/javascript" src="'+DTPath+"api/task.js.php?"+s+"&refresh="+Math.random()+'.js"></sc'+"ript>")}var sell_n=0;function sell_tip(o,i){if(o.checked){sell_n++;Dd("item_"+i).style.backgroundColor="#F1F6FC"}else{Dd("item_"+i).style.backgroundColor="#FFFFFF";sell_n--}if(sell_n<0){sell_n=0}if(sell_n>1){var aTag=o;var leftpos=toppos=0;do{aTag=aTag.offsetParent;leftpos+=aTag.offsetLeft;toppos+=aTag.offsetTop}while(aTag.offsetParent!=null);var X=o.offsetLeft+leftpos-10;var Y=o.offsetTop+toppos-70;Dd("sell_tip").style.left=X+"px";Dd("sell_tip").style.top=Y+"px";o.checked?Ds("sell_tip"):Dh("sell_tip")}else{Dh("sell_tip")}}function img_tip(o,i){if(i){if(i.indexOf("nopic.gif")==-1){if(i.indexOf(".thumb.")!=-1){var t=i.split(".thumb.");var s=t[0]}else{var s=i}var aTag=o;var leftpos=toppos=0;do{aTag=aTag.offsetParent;leftpos+=aTag.offsetLeft;toppos+=aTag.offsetTop}while(aTag.offsetParent!=null);var X=o.offsetLeft+leftpos+90;var Y=o.offsetTop+toppos-20;Dd("img_tip").style.left=X+"px";Dd("img_tip").style.top=Y+"px";Ds("img_tip");Inner("img_tip",'<img src="'+s+"\" onload=\"if(this.width<200) {Dh('img_tip');}else if(this.width>300){this.width=300;}Dd('img_tip').style.width=this.width+'px';\"/>")}}else{Dh("img_tip")}}function GoMobile(url){if((UA.indexOf("phone")!=-1||UA.indexOf("mobile")!=-1||UA.indexOf("android")!=-1||UA.indexOf("ipod")!=-1)&&get_cookie("mobile")!="pc"&&UA.indexOf("ipad")==-1){Go(url)}}function oauth_logout(){set_cookie("oauth_site","");set_cookie("oauth_user","");window.location.reload(true)}function unique(arr){var tmp=new Array();for(var m in arr){tmp[arr[m]]=1}var tmparr=new Array();for(var n in tmp){tmparr.push(n)}return tmparr}function reachBottom(){var scrollTop=0;var clientHeight=0;var scrollHeight=0;if(document.documentElement&&document.documentElement.scrollTop){scrollTop=document.documentElement.scrollTop}else{if(document.body){scrollTop=document.body.scrollTop}}if(document.body.clientHeight&&document.documentElement.clientHeight){clientHeight=(document.body.clientHeight<document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight}else{clientHeight=(document.body.clientHeight>document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight}scrollHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);if(scrollTop+clientHeight==scrollHeight){return true}else{return false}}$(function(){if(get_cookie("history_search")){var history_search_str="";if(/=/.test(get_cookie("history_search"))){var history_search_arr=unique(get_cookie("history_search").split("=").reverse());$.each(history_search_arr,function(i,n){if(i<5){history_search_str=history_search_str+'<a class="uk-button uk-button-mini uk-margin-small-bottom border_radius0" href="javascript:setTip1(\''+$.trim(n)+"');\">"+$.trim(n)+"</a>&nbsp;"}})}else{history_search_str='<a class="uk-button uk-button-mini uk-margin-small-bottom border_radius0" href="javascript:setTip1(\''+$.trim(get_cookie("history_search"))+"');\">"+$.trim(get_cookie("history_search"))+"</a>"}$("#search_history").html(history_search_str)}$(".mb-hover-360").hover(function(){$(this).find("img").first().addClass("uk-icon-spin")},function(){$(this).find("img").first().removeClass("uk-icon-spin")});$(window).scroll(function(){var st=$(document).scrollTop();if(typeof(MBScroll)=="undefined"){if(st>88){if($(document.body).height()-screen.availHeight<88){return}$("#top-header").addClass("fixed_menu");$("#top-header").addClass("uk-animation-scale")}else{$("#top-header").removeClass("uk-animation-scale");$("#top-header").removeClass("fixed_menu")}}if($("#go_bottom")){if(reachBottom()){$("#go_bottom").stop().fadeOut(300)}else{$("#go_bottom").stop().fadeIn(200)}}});if(top!=self&&self.location.href.indexOf(DTPath)==-1){top.location.href=DTPath}});